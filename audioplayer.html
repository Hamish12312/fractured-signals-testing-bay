<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <link rel="stylesheet" href="css/index-style.css" />
        <link rel="stylesheet" href="css/audioplayer.css" />
        <title>Modern Music Player</title>
    </head>
    <body>
        <div class="player">
            <div class="cover" id="cover"></div>
            <div class="info">
                <div class="title" id="title">Title</div>
                <div class="artist" id="artist">Artist</div>
            </div>

            <div class="progress-container" id="progress-container">
                <div class="progress" id="progress"></div>
            </div>

            <div class="controls">
                <button id="prev">⏮️</button>
                <button id="play">▶️</button>
                <button id="next">⏭️</button>
            </div>

            <div class="playlist" id="playlist"></div>
        </div>

        <audio id="audio"></audio>

        <script>
            const songs = [
                {
                    title: "Weakness",
                    artist: "Fractured Signals",
                    src: "music/weakness.mp3",
                    cover: "covers/epcover.jpg"
                },
                {
                    title: "Bullet in the Heart",
                    artist: "Fractured Signals",
                    src: "music/weakness.mp3",
                    cover: "covers/epcover.jpg"
                },
                {
                    title: "I'm Free",
                    artist: "Fractured Signals",
                    src: "music/weakness.mp3",
                    cover: "covers/epcover.jpg"
                }
            ];

            const audio = document.getElementById("audio");
            const title = document.getElementById("title");
            const artist = document.getElementById("artist");
            const cover = document.getElementById("cover");
            const playBtn = document.getElementById("play");
            const prevBtn = document.getElementById("prev");
            const nextBtn = document.getElementById("next");
            const progress = document.getElementById("progress");
            const progressContainer = document.getElementById("progress-container");
            const playlist = document.getElementById("playlist");

            let currentSong = 0;
            let isPlaying = false;

            function loadSong(song) {
                title.textContent = song.title;
                artist.textContent = song.artist;
                cover.style.backgroundImage = `url('${song.cover}')`;
                audio.src = song.src;
            }

            function playSong() {
                isPlaying = true;
                playBtn.textContent = "⏸️";
                audio.play();
            }

            function pauseSong() {
                isPlaying = false;
                playBtn.textContent = "▶️";
                audio.pause();
            }

            playBtn.addEventListener("click", () => {
                isPlaying ? pauseSong() : playSong();
            });

            prevBtn.addEventListener("click", () => {
                currentSong = (currentSong - 1 + songs.length) % songs.length;
                loadSong(songs[currentSong]);
                playSong();
                updatePlaylist();
            });

            nextBtn.addEventListener("click", () => {
                currentSong = (currentSong + 1) % songs.length;
                loadSong(songs[currentSong]);
                playSong();
                updatePlaylist();
            });

            audio.addEventListener("timeupdate", (e) => {
                const { duration, currentTime } = e.srcElement;
                const percent = (currentTime / duration) * 100;
                progress.style.width = percent + "%";
            });

            progressContainer.addEventListener("click", (e) => {
                const width = progressContainer.clientWidth;
                const clickX = e.offsetX;
                const duration = audio.duration;
                audio.currentTime = (clickX / width) * duration;
            });

            audio.addEventListener("ended", () => {
                nextBtn.click();
            });

            function updatePlaylist() {
                playlist.innerHTML = "";
                songs.forEach((song, index) => {
                    const track = document.createElement("div");
                    track.classList.add("track");
                    if (index === currentSong) track.classList.add("active");
                    track.textContent = `${song.title} — ${song.artist}`;
                    track.addEventListener("click", () => {
                        currentSong = index;
                        loadSong(songs[currentSong]);
                        playSong();
                        updatePlaylist();
                    });
                    playlist.appendChild(track);
                });
            }

            // Initialize
            loadSong(songs[currentSong]);
            updatePlaylist();
        </script>
    </body>
</html>